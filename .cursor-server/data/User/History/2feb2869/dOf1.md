# VPN Telegram Bot

Telegram бот для продажи VPN подписок с интеграцией 3xUI панели.

## Возможности

- ✅ Регистрация пользователей через Telegram
- ✅ Авторизация по номеру телефона
- ✅ Два тарифа: 1 месяц (149₽) и 3 месяца (399₽)
- ✅ Интеграция с 3xUI API
- ✅ Автоматическое создание пользователей в 3xUI
- ✅ Выдача конфигураций Reality/VMess
- ✅ Управление подписками

## Установка

### 1. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 2. Настройка базы данных

Создайте PostgreSQL базу данных:

```sql
CREATE DATABASE vpn_bot;
CREATE USER vpn_user WITH PASSWORD 'your_password';
GRANT ALL PRIVILEGES ON DATABASE vpn_bot TO vpn_user;
```

### 3. Настройка переменных окружения

Создайте файл `.env` на основе `env_example.txt`:

```bash
cp env_example.txt .env
```

Заполните переменные:
- `XUI_BASE_URL` - URL вашей 3xUI панели
- `XUI_USERNAME` - логин администратора 3xUI
- `XUI_PASSWORD` - пароль администратора 3xUI
- `DATABASE_URL` - строка подключения к PostgreSQL

### 4. Запуск бота

```bash
python bot.py
```

## Структура проекта

```
├── bot.py              # Основной файл бота
├── config.py           # Конфигурация
├── database.py         # Модели базы данных
├── xui_client.py       # Клиент для работы с 3xUI API
├── requirements.txt    # Зависимости Python
├── env_example.txt     # Пример переменных окружения
└── README.md          # Документация
```

## API 3xUI

### Получение API ключа

В 3xUI нет постоянного API ключа. Авторизация происходит через логин/пароль:

1. Откройте DevTools в браузере (F12)
2. Перейдите на страницу логина 3xUI
3. Введите логин/пароль
4. В Network вкладке найдите запрос `/login`
5. Скопируйте cookies из ответа

### Основные эндпоинты

- `POST /login` - авторизация
- `GET /panel/inbounds` - список inbounds
- `POST /panel/inbound/updateClient/{id}` - создание/обновление пользователя

## Использование

1. Пользователь запускает бота командой `/start`
2. Делится номером телефона
3. Вводит email и имя
4. Выбирает тариф в меню "Купить ключ"
5. Получает конфигурацию для VPN клиента

## Планы развития

- [ ] Интеграция с YooMoney для оплаты
- [ ] Админ панель в боте
- [ ] Автоматическое продление подписок
- [ ] Статистика и аналитика
- [ ] Поддержка множественных серверов

## Поддержка

При возникновении проблем обращайтесь в поддержку: @support
